# Deye-Rescue-01 v1.0.0: Helper Entities
# Required for adaptive power limiting and rescue coordination
#
# INSTALLATION IN HOME ASSISTANT:
# Option 1 (Recommended - UI):
#   1. Settings → Devices & Services → Helpers
#   2. Click "+ CREATE HELPER" for each entity below
#   3. Match the name, min/max, step, and icon exactly
#
# Option 2 (YAML):
#   1. Add this file content to configuration.yaml
#   2. OR: Create /config/helpers.yaml and add to configuration.yaml:
#      homeassistant:
#        customize: !include customize.yaml
#      input_number: !include_dir_merge_named helpers/
#   3. Restart Home Assistant
#
# NOTE: Helper entities CANNOT be created by automations - they must be
# defined in config files or created through the UI before automations run.
#
# Rescue frequency tracking
input_number:
  deye_rescue_count_6h:
    name: "Deye Rescue Count (6h)"
    min: 0
    max: 20
    step: 1
    initial: 0
    icon: mdi:counter
    
input_datetime:
  deye_last_rescue_time:
    name: "Deye Last Rescue Time"
    has_date: true
    has_time: true
    icon: mdi:clock-alert

# State flags (if not already created)
input_boolean:
  deye_rescue_active:
    name: "Deye Rescue Active"
    initial: off
    icon: mdi:battery-alert
    
  deye_ev_charging_active:
    name: "Deye EV Charging Active"
    initial: off
    icon: mdi:ev-station
    
  deye_defrost_detected:
    name: "Deye Heat Pump Defrost Detected"
    initial: off
    icon: mdi:snowflake-alert

# Load tracking for defrost detection
input_number:
  deye_load_previous:
    name: "Deye Previous Load"
    min: 0
    max: 10000
    step: 1
    initial: 0
    unit_of_measurement: "W"
    icon: mdi:flash
    
  deye_defrost_temporary_limit:
    name: "Deye Defrost Temporary Limit"
    min: 0
    max: 100
    step: 1
    initial: 60
    unit_of_measurement: "A"
    icon: mdi:gauge

# Zone tracking
input_text:
  deye_discharge_zone:
    name: "Deye Discharge Zone"
    initial: "none"
    icon: mdi:gauge

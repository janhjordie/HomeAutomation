# GitHub Copilot Instructions for HomeAutomation

## YAML File Management

### When Editing HomeAssistant YAML Automations

Every time you make changes to a YAML file in the `HomeAssistant/` directory:

1. **Validate the YAML syntax**
   - Run: `python3 -c "import yaml; yaml.safe_load(open('HomeAssistant/[filename].yaml'))" && echo "✅ Valid" || echo "❌ Invalid"`
   - Ensure the file is valid before proceeding

2. **Increment the Version Number in TWO places**
   - **alias field**: Update version in format `Deye-XX vX.Y.Z: Description`
     - Example: `alias: "Deye-03 v2.2.7: Discharge Cap"` → `alias: "Deye-03 v2.2.8: Discharge Cap"`
   - **description field**: Update version in format `[vX.Y.Z]`
     - Example: `description: "[v2.2.7] Description"` → `description: "[v2.2.8] Description"`
   - Increment the **MINOR** version (Y) by 1 for bug fixes and feature changes
   - Increment the **PATCH** version (Z) by 1 for minor tweaks or documentation
   - Example: `v1.0.0` → `v1.1.0`, `v2.1.0` → `v2.2.0`
   - If no version exists, start with `v1.0.0`
   - **CRITICAL**: Both alias and description versions MUST match!

3. **Commit with Clear Message**
   - Include the file name and version update
   - Example: `v2.2.8: Update Deye-03 - Simplify discharge cap enforcement`

### Version Scheme

- **MAJOR (X)**: Breaking changes that fundamentally alter behavior
- **MINOR (Y)**: Feature additions, threshold adjustments, or bug fixes
- **PATCH (Z)**: Reserved for documentation or comment-only changes

### Example Workflow

```yaml
# BEFORE
alias: "Deye-03 v2.2.7: Discharge Cap (SOC-based sliding)"
description: "[v2.2.7] Original description"

# AFTER editing
alias: "Deye-03 v2.2.8: Discharge Cap (SOC-based sliding)"
description: "[v2.2.8] Updated description with changes"
```

Then validate:
```bash
python3 -c "import yaml; yaml.safe_load(open('HomeAssistant/Deye-XX.yaml'))"
```

---

**Apply to**: All YAML files in `HomeAssistant/` directory
